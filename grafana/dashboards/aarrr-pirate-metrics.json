{
  "annotations": { "list": [] },
  "editable": true,
  "fiscalYearStartMonth": 0,
  "graphTooltip": 1,
  "id": null,
  "links": [],
  "liveNow": false,
  "panels": [
    {
      "type": "row",
      "title": "üè¥‚Äç‚ò†Ô∏è ACQUISITION ‚Äî How do users find us?",
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 0 },
      "collapsed": false
    },
    {
      "type": "stat",
      "title": "Visitors (Today)",
      "gridPos": { "h": 4, "w": 4, "x": 0, "y": 1 },
      "targets": [{
        "rawSql": "SELECT COUNT(DISTINCT visitor_id) FROM analytics_page_views WHERE created_at >= CURRENT_DATE",
        "refId": "A", "format": "table"
      }],
      "fieldConfig": { "defaults": { "color": { "mode": "thresholds" }, "thresholds": { "steps": [{"color": "blue", "value": null}, {"color": "green", "value": 10}] } } }
    },
    {
      "type": "stat",
      "title": "Sessions (Today)",
      "gridPos": { "h": 4, "w": 4, "x": 4, "y": 1 },
      "targets": [{
        "rawSql": "SELECT COUNT(DISTINCT session_id) FROM analytics_page_views WHERE created_at >= CURRENT_DATE",
        "refId": "A", "format": "table"
      }]
    },
    {
      "type": "stat",
      "title": "Page Views (Today)",
      "gridPos": { "h": 4, "w": 4, "x": 8, "y": 1 },
      "targets": [{
        "rawSql": "SELECT COUNT(*) FROM analytics_page_views WHERE created_at >= CURRENT_DATE",
        "refId": "A", "format": "table"
      }]
    },
    {
      "type": "stat",
      "title": "Pages/Session",
      "gridPos": { "h": 4, "w": 4, "x": 12, "y": 1 },
      "targets": [{
        "rawSql": "SELECT ROUND(COUNT(*)::numeric / NULLIF(COUNT(DISTINCT session_id), 0), 1) FROM analytics_page_views WHERE created_at >= CURRENT_DATE",
        "refId": "A", "format": "table"
      }]
    },
    {
      "type": "stat",
      "title": "Contacts (All Time)",
      "gridPos": { "h": 4, "w": 4, "x": 16, "y": 1 },
      "targets": [{
        "rawSql": "SELECT COUNT(*) FROM contact_submissions",
        "refId": "A", "format": "table"
      }],
      "fieldConfig": { "defaults": { "color": { "mode": "thresholds" }, "thresholds": { "steps": [{"color": "orange", "value": null}, {"color": "green", "value": 5}] } } }
    },
    {
      "type": "stat",
      "title": "Waitlist (All Time)",
      "gridPos": { "h": 4, "w": 4, "x": 20, "y": 1 },
      "targets": [{
        "rawSql": "SELECT COUNT(*) FROM waitlist_entries",
        "refId": "A", "format": "table"
      }]
    },
    {
      "type": "timeseries",
      "title": "Daily Traffic ‚Äî Visitors & Sessions",
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 5 },
      "targets": [{
        "rawSql": "SELECT day as time, unique_visitors, sessions FROM v_daily_traffic WHERE day >= $__timeFrom()::date ORDER BY day",
        "refId": "A", "format": "table"
      }],
      "fieldConfig": { "defaults": { "custom": { "fillOpacity": 15 } } }
    },
    {
      "type": "piechart",
      "title": "Traffic Sources",
      "gridPos": { "h": 8, "w": 6, "x": 12, "y": 5 },
      "targets": [{
        "rawSql": "SELECT source, SUM(unique_visitors) as visitors FROM v_traffic_by_source WHERE day >= $__timeFrom()::date GROUP BY source ORDER BY visitors DESC LIMIT 10",
        "refId": "A", "format": "table"
      }]
    },
    {
      "type": "table",
      "title": "Top Pages",
      "gridPos": { "h": 8, "w": 6, "x": 18, "y": 5 },
      "targets": [{
        "rawSql": "SELECT path, SUM(views) as views, SUM(unique_visitors) as visitors FROM v_top_pages WHERE day >= $__timeFrom()::date GROUP BY path ORDER BY views DESC LIMIT 15",
        "refId": "A", "format": "table"
      }]
    },
    {
      "type": "row",
      "title": "‚ö° ACTIVATION ‚Äî Do visitors experience the aha moment?",
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 13 },
      "collapsed": false
    },
    {
      "type": "timeseries",
      "title": "Daily Funnel: Visitors ‚Üí CTA Clicks ‚Üí Contacts ‚Üí Waitlist",
      "gridPos": { "h": 8, "w": 16, "x": 0, "y": 14 },
      "targets": [{
        "rawSql": "SELECT day as time, visitors, cta_clicks, contact_submissions, waitlist_joins FROM v_daily_funnel WHERE day >= $__timeFrom()::date ORDER BY day",
        "refId": "A", "format": "table"
      }],
      "fieldConfig": { "defaults": { "custom": { "fillOpacity": 10 } } }
    },
    {
      "type": "gauge",
      "title": "CTA Click Rate %",
      "gridPos": { "h": 4, "w": 4, "x": 16, "y": 14 },
      "targets": [{
        "rawSql": "SELECT ROUND(COUNT(DISTINCT CASE WHEN e.event_name = 'cta_click' THEN e.visitor_id END)::numeric / NULLIF(COUNT(DISTINCT pv.visitor_id), 0) * 100, 1) FROM analytics_page_views pv LEFT JOIN analytics_events e ON pv.visitor_id = e.visitor_id AND e.created_at >= $__timeFrom() WHERE pv.created_at >= $__timeFrom()",
        "refId": "A", "format": "table"
      }],
      "fieldConfig": { "defaults": { "min": 0, "max": 100, "thresholds": { "steps": [{"color": "red", "value": null}, {"color": "yellow", "value": 2}, {"color": "green", "value": 5}] } } }
    },
    {
      "type": "gauge",
      "title": "Contact Rate %",
      "gridPos": { "h": 4, "w": 4, "x": 20, "y": 14 },
      "targets": [{
        "rawSql": "SELECT ROUND(COUNT(*)::numeric / NULLIF((SELECT COUNT(DISTINCT visitor_id) FROM analytics_page_views WHERE created_at >= $__timeFrom()), 0) * 100, 2) FROM contact_submissions WHERE created_at >= $__timeFrom()",
        "refId": "A", "format": "table"
      }],
      "fieldConfig": { "defaults": { "min": 0, "max": 100, "thresholds": { "steps": [{"color": "red", "value": null}, {"color": "yellow", "value": 1}, {"color": "green", "value": 3}] } } }
    },
    {
      "type": "bargauge",
      "title": "Events by Category (AARRR)",
      "gridPos": { "h": 4, "w": 8, "x": 16, "y": 18 },
      "targets": [{
        "rawSql": "SELECT event_category, COUNT(*) as events FROM analytics_events WHERE created_at >= $__timeFrom() GROUP BY event_category ORDER BY events DESC",
        "refId": "A", "format": "table"
      }]
    },
    {
      "type": "row",
      "title": "üîÑ RETENTION ‚Äî Do visitors come back?",
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 22 },
      "collapsed": false
    },
    {
      "type": "heatmap",
      "title": "Weekly Retention Cohorts",
      "description": "Rows = cohort signup week, Columns = weeks since first visit, Color = # returning visitors",
      "gridPos": { "h": 8, "w": 16, "x": 0, "y": 23 },
      "targets": [{
        "rawSql": "SELECT cohort_week as time, weeks_since_first, returning_visitors FROM v_weekly_retention WHERE cohort_week >= $__timeFrom()::date ORDER BY cohort_week, weeks_since_first",
        "refId": "A", "format": "table"
      }]
    },
    {
      "type": "stat",
      "title": "Returning Visitor Rate %",
      "description": "% of today's visitors who have visited before",
      "gridPos": { "h": 4, "w": 8, "x": 16, "y": 23 },
      "targets": [{
        "rawSql": "WITH today_visitors AS (SELECT DISTINCT visitor_id FROM analytics_page_views WHERE created_at >= CURRENT_DATE), returning AS (SELECT tv.visitor_id FROM today_visitors tv WHERE EXISTS (SELECT 1 FROM analytics_page_views pv WHERE pv.visitor_id = tv.visitor_id AND pv.created_at < CURRENT_DATE)) SELECT ROUND(COUNT(*)::numeric / NULLIF((SELECT COUNT(*) FROM today_visitors), 0) * 100, 1) FROM returning",
        "refId": "A", "format": "table"
      }],
      "fieldConfig": { "defaults": { "thresholds": { "steps": [{"color": "red", "value": null}, {"color": "yellow", "value": 15}, {"color": "green", "value": 30}] } } }
    },
    {
      "type": "stat",
      "title": "Blog Re-reads",
      "gridPos": { "h": 4, "w": 8, "x": 16, "y": 27 },
      "targets": [{
        "rawSql": "SELECT COUNT(*) FROM analytics_events WHERE event_name = 'blog_read' AND created_at >= $__timeFrom()",
        "refId": "A", "format": "table"
      }]
    },
    {
      "type": "row",
      "title": "üöÄ PILOT CAMPAIGN ‚Äî 2026 Precision Labor Intelligence",
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 31 },
      "collapsed": false
    },
    {
      "type": "stat",
      "title": "Pilot Signups (All Time)",
      "gridPos": { "h": 4, "w": 6, "x": 0, "y": 32 },
      "targets": [{
        "rawSql": "SELECT COUNT(*) FROM waitlist_entries WHERE interest = 'pilot_2026'",
        "refId": "A", "format": "table"
      }],
      "fieldConfig": { "defaults": { "color": { "mode": "thresholds" }, "thresholds": { "steps": [{"color": "orange", "value": null}, {"color": "yellow", "value": 5}, {"color": "green", "value": 10}] } } }
    },
    {
      "type": "gauge",
      "title": "Pilot Signup Rate %",
      "description": "Pilot signups / unique homepage visitors √ó 100. Target: ‚â•3%",
      "gridPos": { "h": 4, "w": 6, "x": 6, "y": 32 },
      "targets": [{
        "rawSql": "SELECT ROUND(COALESCE(COUNT(w.*)::numeric / NULLIF((SELECT COUNT(DISTINCT visitor_id) FROM analytics_page_views WHERE path = '/' AND created_at >= $__timeFrom()), 0) * 100, 0), 2) FROM waitlist_entries w WHERE w.interest = 'pilot_2026' AND w.created_at >= $__timeFrom()",
        "refId": "A", "format": "table"
      }],
      "fieldConfig": { "defaults": { "min": 0, "max": 10, "thresholds": { "steps": [{"color": "red", "value": null}, {"color": "yellow", "value": 1.5}, {"color": "green", "value": 3}] } } }
    },
    {
      "type": "timeseries",
      "title": "Pilot Funnel ‚Äî Daily: Visitors ‚Üí CTA Clicks ‚Üí Signups",
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 32 },
      "targets": [{
        "rawSql": "SELECT d.day as time, COALESCE(v.visitors, 0) as homepage_visitors, COALESCE(c.cta_clicks, 0) as pilot_cta_clicks, COALESCE(s.signups, 0) as pilot_signups FROM generate_series($__timeFrom()::date, $__timeTo()::date, '1 day') d(day) LEFT JOIN (SELECT DATE(created_at) as day, COUNT(DISTINCT visitor_id) as visitors FROM analytics_page_views WHERE path = '/' GROUP BY DATE(created_at)) v ON d.day = v.day LEFT JOIN (SELECT DATE(created_at) as day, COUNT(*) as cta_clicks FROM analytics_events WHERE event_name = 'cta_click' AND event_label IN ('hero_pilot_cta', 'cta_reserve_spot', 'nav_pilot_cta') GROUP BY DATE(created_at)) c ON d.day = c.day LEFT JOIN (SELECT DATE(created_at) as day, COUNT(*) as signups FROM waitlist_entries WHERE interest = 'pilot_2026' GROUP BY DATE(created_at)) s ON d.day = s.day ORDER BY d.day",
        "refId": "A", "format": "table"
      }],
      "fieldConfig": { "defaults": { "custom": { "fillOpacity": 10 } } }
    },
    {
      "type": "table",
      "title": "Recent Pilot Signups",
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 36 },
      "targets": [{
        "rawSql": "SELECT email, name, company, created_at FROM waitlist_entries WHERE interest = 'pilot_2026' ORDER BY created_at DESC LIMIT 20",
        "refId": "A", "format": "table"
      }]
    },
    {
      "type": "row",
      "title": "üß™ EXPERIMENTS ‚Äî Lean Startup Hypotheses",
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 44 },
      "collapsed": false
    },
    {
      "type": "table",
      "title": "Active Experiments",
      "gridPos": { "h": 8, "w": 24, "x": 0, "y": 45 },
      "targets": [{
        "rawSql": "SELECT name, hypothesis, metric_name, baseline_value, target_value, current_value, status, started_at, CASE WHEN target_value IS NOT NULL AND current_value IS NOT NULL AND target_value != 0 THEN ROUND(current_value / target_value * 100, 1) ELSE NULL END as progress_pct FROM experiments ORDER BY CASE status WHEN 'active' THEN 0 WHEN 'validated' THEN 1 WHEN 'invalidated' THEN 2 ELSE 3 END, started_at DESC",
        "refId": "A", "format": "table"
      }],
      "fieldConfig": {
        "overrides": [
          { "matcher": { "id": "byName", "options": "status" }, "properties": [{ "id": "custom.cellOptions", "value": { "type": "color-text" } }, { "id": "mappings", "value": [{ "options": { "validated": { "color": "green", "text": "‚úÖ Validated" }, "invalidated": { "color": "red", "text": "‚ùå Invalidated" }, "active": { "color": "blue", "text": "üî¨ Active" }, "paused": { "color": "gray", "text": "‚è∏ Paused" } }, "type": "value" }] }] }
        ]
      }
    }
  ],
  "refresh": "30s",
  "schemaVersion": 39,
  "tags": ["terroir", "aarrr", "lean-startup"],
  "templating": { "list": [] },
  "time": { "from": "now-30d", "to": "now" },
  "timepicker": {},
  "timezone": "browser",
  "title": "üè¥‚Äç‚ò†Ô∏è AARRR Pirate Metrics ‚Äî Terroir AI",
  "uid": "terroir-aarrr",
  "version": 1
}
